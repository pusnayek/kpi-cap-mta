sap.ui.define(["sap/ui/base/Object","sap/ui/model/json/JSONModel","sap/ui/model/Filter","sap/ui/model/FilterOperator"],function(e,t,r,i){"use strict";return e.extend("ui.lms.utils.FilterController",{prepareUserFilter:function(e){return new r("ACTING_USERID","EQ",e)},prepareModeFilter:function(e){return new r("ACTOR","EQ",e)},getPopulationFilter:function(e,t){return[this.prepareUserFilter(e),this.prepareModeFilter(t)]},unique:function(e,t){return[...new Set(e.map(e=>e[t]))].filter(function(e){return e&&e.length>0})},uniqueKeyValues:function(e,t,r){var i={},n=[];var u=this;$.each(e,$.proxy(function(e,n){i[n[t]]=n[r]},u));window.Object.keys(i).sort().forEach(function(e){n.push({key:e,text:i[e]})});return n.filter(function(e){return e.key&&e.key.length>0&&(e.text&&e.text.length>0)})},setModel:function(e,r,i){var n=this;var u=undefined;if("COMPETENCY_ID"===e){u=new t({items:n.uniqueKeyValues(r,"COMPETENCY_ID","COMPETENCY_NAME")})}else if("COMPETENCY_AREA"===e){u=new t({items:n.uniqueKeyValues(r,"COMPETENCY_AREA","COMPETENCY_DESCRIPTION")})}else{var o=n.unique(r,e).filter(function(e){return e&&e.length>0});u=new t({items:o.map(function(e){return{key:e}})})}var a=u.getData().items.length;u.setSizeLimit(a);i.getView().setModel(u,e)},updateModels:function(e,t,r){var i=this;$.each(e,$.proxy(function(e,n){i.setModel(n,t,r)},i))},initialize:function(e,r,i){var n=this;this.data=r;this.order=["DOMAIN","DIVISION","GROUPBU","DEPARTMENT","JOBGROUP","JOBCODE","JOBLOCATION","EMPLOYEEGROUP","EMPCUSTOMSTATUS","COMPETENCY_AREA","COMPETENCY_ID"];this.updateModels(this.order,this.data,i);i.getView().setModel(new t({population:e,DOMAIN:[],DIVISION:[],GROUPBU:[],DEPARTMENT:[],JOBCODE:[],JOBGROUP:[],JOBLOCATION:[],EMPLOYEEGROUP:[],EMPCUSTOMSTATUS:[],COMPETENCY_AREA:[],COMPETENCY_ID:[]}),"filterSelections")},refresh:function(e,r){var i=this;var n=this.data;var u=e.getView().getModel("filterSelections");if(u){var o=u.getData();if(o){var a=[...i.order];a=i.getAdjustedOrder(a,r);$.each(a,$.proxy(function(e,t){o[t]=[]},i));e.getView().setModel(new t(o),"filterSelections");$.each(i.order,$.proxy(function(e,t){if(o[t]&&o[t].length>0){n=n.filter(function(e){return o[t].includes(e[t])})}},i));i.updateModels(a,n,e)}}},getAdjustedOrder:function(e,t){var r=e.indexOf(t);for(var i=0;i<=r;i++){e.shift()}return e},getAllFilters:function(e,t){var n=this;var u=[];var o=t===undefined?n.order:t;var a=e.getView().getModel("filterSelections");var l=a.getData();if(l){$.each(o,$.proxy(function(e,t){if(l[t]&&l[t].length>0){var o=[];$.each(l[t],$.proxy(function(e,n){o.push(new r(t,i.EQ,n))},n));if(o.length>0){if(o.length===1){u.push(o[0])}else{u.push(new r({filters:o,and:false}))}}}},n))}return u},getAllFilterValues:function(e){var t=this;var r=[];var i=e.getView().getModel("filterSelections");var n=i.getData();if(n){$.each(t.order,$.proxy(function(e,i){if(n[i]&&n[i].length>0){var u=[];$.each(n[i],$.proxy(function(e,t){u.push(btoa(encodeURIComponent(t)))},t));r.push({name:i,values:u})}},t))}return r}})},false);
//# sourceMappingURL=FilterController.js.map