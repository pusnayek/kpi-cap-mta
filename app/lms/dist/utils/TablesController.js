sap.ui.define(["sap/ui/base/Object","sap/ui/model/json/JSONModel","sap/ui/model/Filter","ui/lms/utils/ServiceUrlProvider"],function(e,t,i,n){"use strict";return e.extend("ui.lms.utils.TablesController",{init:function(){var e=this;return new Promise(function(t,i){$.getJSON(n.TableConfig,function(i){e.configuration=i;t()})})},iterateTables:function(e){var t=this;var i=[...new Set(t.configuration.map(e=>e["Table"]))];$.each(i,function(t,i){e(i)})},getTables:function(e){return this.configuration.filter(function(t){return e===t.Actor})},getVisibilityModel:function(e,i){var n={CompetencyStatus:false,CompetencyGaps:false,ByEmployees:false,ByCompetencies:false,ByManagers:false,ByCompanies:false,ByDivisions:false,ByDepartments:false};$.each(i,function(e,t){n[t.Table]=true});return new t(n)},initializeTables:function(e){var t=this;var i=this.getTables(e.mode);e.getView().setModel(t.getVisibilityModel(e.mode,i),"tableVisibilityModel");var n=e.filterController.getPopulationFilter(e.userInfo.user,e.mode);$.each(i,function(i,a){var s=e.getView().byId(a.Table)||sap.ui.getCore().byId(a.Table);if(s){if(a.Table==="CompetencyStatus"||a.Table==="CompetencyGaps"){var r=s.getBinding("items");if(r&&r.filter){r.filter(n)}}else{t.refreshAggregatedTables(e,n,a.Table,s)}}})},refreshAggregatedTables:function(e,i,n,a){if(n==="ByCompanies"){e.dataManager.getCompentenciesByCompanies(e,i).then(function(e){a.setModel(new t(e))}).catch(function(e){})}else if(n==="ByDepartments"){e.dataManager.getCompentenciesByDepartments(e,i).then(function(e){a.setModel(new t(e))}).catch(function(e){})}else if(n==="ByDivisions"){e.dataManager.getCompentenciesByDivisions(e,i).then(function(e){a.setModel(new t(e))}).catch(function(e){})}else if(n==="ByEmployees"){e.dataManager.getCompentenciesByEmployees(e,i).then(function(e){a.setModel(new t(e))}).catch(function(e){})}else if(n==="ByManagers"){e.dataManager.getCompentenciesByManagers(e,i).then(function(e){a.setModel(new t(e))}).catch(function(e){})}else if(n==="ByCompetencies"){e.dataManager.getCompentenciesByCompetencies(e,i).then(function(e){a.setModel(new t(e))}).catch(function(e){})}},refreshFilters:function(e){var t=this;var i=this.getTables(e.mode);var n=e.filterController.getPopulationFilter(e.userInfo.user,e.mode);$.each(i,function(i,a){var s=[...n].concat(e.filterController.getAllFilters(e,a.Filter));var r=e.getView().byId(a.Table)||sap.ui.getCore().byId(a.Table);if(r){if(a.Table==="CompetencyStatus"||a.Table==="CompetencyGaps"){var l=r.getBinding("items");if(l&&l.filter){l.filter(s)}}else{t.refreshAggregatedTables(e,s,a.Table,r)}}})},initializeTable:function(e,t){var i=this;var n=this.getTables(e.mode).filter(function(e){return t===e.Table});var a=e.filterController.getPopulationFilter(e.userInfo.user,e.mode);$.each(n,function(n,s){var r=e.getView().byId(s.Table)||sap.ui.getCore().byId(s.Table);var l=a.concat(e.filterController.getAllFilters(e,s.Filter));if(r){if(t==="CompetencyStatus"||t==="CompetencyGaps"){var o=r.getBinding("items");if(o&&o.filter){o.filter(l)}}else{i.refreshAggregatedTables(e,l,t,r)}}})}})},false);
//# sourceMappingURL=TablesController.js.map